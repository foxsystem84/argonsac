---
import { Icon } from "astro-icon/components";
---

<section class="bg-[#F3F6FB] py-28 mt-0">
  <div class="mx-auto container">
    <div class="px-4 lg:px-0 grid grid-cols-1 lg:grid-cols-2 gap-10 lg:gap-20">
      <div>
        <div class="mb-10">
          <h2 class="text-2xl lg:text-5xl font-bold font-exo text-primary mb-4">
            Contáctenos
          </h2>
          <p class="text-paragraph text-xl leading-relaxed">
            No dude en comunicarse con nosotros. Nuestro equipo de atención al
            cliente está a su disposición para brindarle asistencia con
            cualquier consulta general que pueda tener.
          </p>
        </div>
        <div class="rounded-xl overflow-hidden">
          <div class="m-1">
            <form
              action="https://api.web3forms.com/submit"
              method="POST"
              id="form"
              class="needs-validation"
              novalidate
            >
              <input
                type="hidden"
                name="access_key"
                value={import.meta.env.ASTRO_SITE}
              />
              <input
                type="hidden"
                name="subject"
                value="Nuevo envio desde www.argonsac.com"
              />

              <input
                type="checkbox"
                name="botcheck"
                id=""
                style="display: none;"
              />

              <div class="flex flex-col mb-0 lg:flex-row lg:mb-6 lg:space-x-4">
                <div class="mb-6 w-full lg:w-1/2 lg:mb-0">
                  <input
                    type="text"
                    name="name"
                    id="first_name"
                    placeholder="Tu nombre"
                    required
                    class="w-full px-3 py-4 placeholder-[#6c757d] rounded-md focus:outline-none focus:ring focus:ring-indigo-100 focus:border-indigo-300"
                  />
                  <div
                    class="empty-feedback invalid-feedback text-red-400 text-sm mt-1"
                  >
                    Por favor, ingrese su nombre y apellido
                  </div>
                </div>

                <div class="mb-6 w-full lg:w-1/2 lg:mb-0">
                  <input
                    type="number"
                    name="phone"
                    id="phone"
                    placeholder="Tu número teléfono"
                    required
                    class="w-full px-3 py-4 placeholder-[#6c757d] rounded-md focus:outline-none focus:ring focus:ring-indigo-100 focus:border-indigo-300"
                  />
                  <div
                    class="empty-feedback invalid-feedback text-red-400 text-sm mt-1"
                  >
                    Por favor, ingrese su número teléfono.
                  </div>
                </div>
              </div>

              <div class="mb-6">
                <input
                  type="email"
                  name="email"
                  id="email"
                  placeholder="Tu correo"
                  required
                  class="w-full px-3 py-4 placeholder-[#6c757d] rounded-md focus:outline-none focus:ring focus:ring-indigo-100 focus:border-indigo-300"
                />
                <div class="empty-feedback text-red-400 text-sm mt-1">
                  Por favor, ingrese su correo.
                </div>
                <div class="invalid-feedback text-red-400 text-sm mt-1">
                  Por favor, ingrese un correo válido.
                </div>
              </div>

              <div class="mb-6">
                <textarea
                  rows="5"
                  name="message"
                  id="message"
                  placeholder="Cuentanos más..."
                  class="w-full px-3 py-2 placeholder-[#6c757d] rounded-md focus:outline-none focus:ring focus:ring-indigo-100 focus:border-indigo-300"
                  required></textarea>
                <div
                  class="empty-feedback invalid-feedback text-red-400 text-sm mt-1"
                >
                  Por favor, ingrese su mensaje.
                </div>
              </div>
              <div class="mb-6">
                <input
                  disabled
                  id="captchaTxt"
                  type="text"
                  value=""
                  class="px-3 py-2 border-2 border-gray-200 rounded-md focus:outline-none focus:ring focus:ring-indigo-100 focus:border-indigo-300 w-[200px]"
                />
                <input
                  id="captchaEnter"
                  type="text"
                  placeholder="Ingrese código captcha"
                  class="mt-2 lg:ml-2 px-3 py-2 placeholder-[#6c757d] rounded-md focus:outline-none focus:ring focus:ring-indigo-100 focus:border-indigo-300 w-[200px]"
                  required
                />
                <div
                  class="empty-feedback invalid-feedback text-red-400 text-sm mt-1"
                >
                  Por favor, ingrese el código captcha.
                </div>
              </div>
              <div class="mb-6">
                <button
                  type="submit"
                  class="py-3 px-10 rounded-full bg-[#1B5FC1] border-2 border-[#1B5FC1] font-semibold text-white uppercase hover:border-2 hover:bg-white ease-in-out duration-300 hover:text-black"
                >
                  Enviar mensaje
                </button>
              </div>
              <span class="text-base text-center text-gray-400" id="result"
              ></span>
            </form>
          </div>
        </div>
      </div>
      <div class="mt-7 text-[#075073]">
        <div class="mb-5">
          <h6 class="text-xl font-semibold border-b-[1px] pb-1 mb-2">
            Teléfonos
          </h6>
          <div class="flex items-center">
            <span class="block w-5 h-5 mr-4"><Icon name="phone" /></span>
            <span class="block">983 392 903</span>
          </div>
          <div class="flex items-center">
            <span class="block w-5 h-5 mr-4"><Icon name="phone" /></span>
            <span class="block">944 604 339</span>
          </div>
        </div>
        <div class="mb-5">
          <h6 class="text-xl font-semibold border-b-[1px] pb-1 mb-2">Email</h6>
          <div class="flex items-center">
            <span class="block w-5 h-5 mr-4"><Icon name="envelope" /></span>
            <span class="block">operaciones@argonsac.com</span>
          </div>
        </div>
        <div class="mb-5">
          <h6 class="text-xl font-semibold border-b-[1px] pb-1 mb-2">
            Dirección
          </h6>
          <div class="flex items-center">
            <span class="block w-5 h-5 mr-4"><Icon name="map" /></span>
            <span class="block"
              >Calle Cappa 161-165 Urb. Parque Internacional de la Industria y
              Comercio - Callao.
            </span>
          </div>
        </div>
        <div class="mb-5">
          <h6 class="text-xl font-semibold border-b-[1px] pb-1 mb-2">
            Horario de atención
          </h6>
          <div class="flex items-center">
            <span class="block w-5 h-5 mr-4"><Icon name="clock" /></span>
            <span class="block">Lunes a Viernes: 08:00 am a 6:00 pm</span>
          </div>
          <div class="flex items-center">
            <span class="block w-5 h-5 mr-4"><Icon name="clock" /></span>
            <span class="block">Sábados: 09:00 am a 12:00 pm</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<iframe
  src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3901.889172445926!2d-77.09165501245441!3d-12.051145790406844!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x9105c9406a974431%3A0x91f67a9f9b930a7a!2sARGON%20PHARMA%20SAC!5e0!3m2!1ses!2spe!4v1733405938232!5m2!1ses!2spe"
  width="100%"
  height="500"
  style="border:0;"
  allowfullscreen=""
  loading="lazy"
  referrerpolicy="no-referrer-when-downgrade"></iframe>

<style>
  #captchaTxt {
    background: url(/images/cap.jpg);
    color: #ff4500;
    font-size: 24px;
    font-weight: 600;
    text-align: center;
  }

  .invalid-feedback,
  .empty-feedback {
    display: none;
  }

  .was-validated :placeholder-shown:invalid ~ .empty-feedback {
    display: block;
  }

  .was-validated :not(:placeholder-shown):invalid ~ .invalid-feedback {
    display: block;
  }

  .is-invalid,
  .was-validated :invalid {
    border-color: #dc3545;
  }
</style>

<script>
  let captcha: string, chars;
  let check: any;
  let captchaTxt: any;

  function genNewCaptcha() {
    chars = "1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
    captcha = chars[Math.floor(Math.random() * chars.length)];
    for (var i = 0; i < 6; i++) {
      captcha = captcha + chars[Math.floor(Math.random() * chars.length)];
    }
    captchaTxt = document.getElementById("captchaTxt");
    captchaTxt.value = captcha;
  }
  genNewCaptcha();

  function checkCaptcha() {
    check = document.getElementById("captchaEnter");

    if (captcha == check.value) {
      return true;
    } else {
      return false;
    }
  }

  (function () {
    "use strict";
    /*
     * Form Validation
     */

    // Fetch all the forms we want to apply custom validation styles to
    const forms = document.querySelectorAll(".needs-validation");
    const result = document.getElementById("result") as HTMLSpanElement;
    // Loop over them and prevent submission
    Array.prototype.slice.call(forms).forEach(function (form) {
      form.addEventListener(
        "submit",
        function (event: any) {
          if (!form.checkValidity()) {
            event.preventDefault();
            event.stopPropagation();

            form.querySelectorAll(":invalid")[0].focus();
          } else {
            /*
             * Form Submission using fetch()
             */
            if (!checkCaptcha()) {
              event.preventDefault();
              result.innerHTML = "Captcha invalido";
              genNewCaptcha();
              return;
            }

            const formData = new FormData(form);
            event.preventDefault();
            event.stopPropagation();

            const object: { [key: string]: any } = {};
            formData.forEach((value: any, key: string) => {
              object[key] = value;
            });
            const json = JSON.stringify(object);
            result.innerHTML = "Por favor espere...";

            fetch("https://api.web3forms.com/submit", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
                Accept: "application/json",
              },
              body: json,
            })
              .then(async (response) => {
                let json = await response.json();
                if (response.status == 200 && checkCaptcha()) {
                  result.innerHTML = json.message;
                  result.classList.remove("text-gray-500");
                  result.classList.add("text-green-500");
                } else {
                  result.innerHTML = json.message;
                  result.innerHTML = "Captcha invalido";
                  result.classList.remove("text-gray-500");
                  result.classList.add("text-red-500");
                }
              })
              .catch((error) => {
                //console.log(error);
                result.innerHTML = "Algo salió mal!";
              })
              .then(function () {
                form.reset();
                form.classList.remove("was-validated");
                setTimeout(() => {
                  result.style.display = "none";
                  result.classList.add("text-green-500");
                  window.location.reload();
                }, 3000);
              });
          }
          form.classList.add("was-validated");
        },
        false
      );
    });
  })();
</script>
